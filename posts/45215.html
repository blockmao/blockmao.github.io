<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>零拷贝 - 牛觅博客</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="牛觅博客"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="牛觅博客"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content=""><meta property="og:type" content="blog"><meta property="og:title" content="零拷贝"><meta property="og:url" content="http://blog.blockmao.cn/posts/45215.html"><meta property="og:site_name" content="牛觅博客"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619205023vz3f2o.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619211045SSoeFe.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619211517AlprCv.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619212016ieRHQD.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619212541y7show.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619213243qeFckV.jpg"><meta property="og:image" content="https://gitee.com/niumi/drawing/raw/master/20210619213506rcq3a0.jpg"><meta property="article:published_time" content="2021-06-19T14:06:18.000Z"><meta property="article:modified_time" content="2021-06-19T14:12:31.562Z"><meta property="article:author" content="牛觅"><meta property="article:tag" content="零拷贝"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://gitee.com/niumi/drawing/raw/master/20210619205023vz3f2o.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.blockmao.cn/posts/45215.html"},"headline":"零拷贝","image":["https://gitee.com/niumi/drawing/raw/master/20210619205023vz3f2o.jpg","https://gitee.com/niumi/drawing/raw/master/20210619211045SSoeFe.jpg","https://gitee.com/niumi/drawing/raw/master/20210619211517AlprCv.jpg","https://gitee.com/niumi/drawing/raw/master/20210619212016ieRHQD.jpg","https://gitee.com/niumi/drawing/raw/master/20210619212541y7show.jpg","https://gitee.com/niumi/drawing/raw/master/20210619213243qeFckV.jpg","https://gitee.com/niumi/drawing/raw/master/20210619213506rcq3a0.jpg"],"datePublished":"2021-06-19T14:06:18.000Z","dateModified":"2021-06-19T14:12:31.562Z","author":{"@type":"Person","name":"牛觅"},"publisher":{"@type":"Organization","name":"牛觅博客","logo":{"@type":"ImageObject","url":"http://blog.blockmao.cn/img/logo.svg"}},"description":""}</script><link rel="canonical" href="http://blog.blockmao.cn/posts/45215.html"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="牛觅博客" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item search" title="Search" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Posted&nbsp;<time dateTime="2021-06-19T14:06:18.000Z" title="2021/6/19下午10:06:18">2021-06-19</time></span><span class="level-item">Updated&nbsp;<time dateTime="2021-06-19T14:12:31.562Z" title="2021/6/19下午10:12:31">2021-06-19</time></span><span class="level-item">15 minutes read (About 2197 words)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>&nbsp;visits</span></div></div><h1 class="title is-3 is-size-4-mobile">零拷贝</h1><div class="content"><p><img src="https://gitee.com/niumi/drawing/raw/master/20210619205023vz3f2o.jpg" alt="20210619205023vz3f2o"></p>
<span id="more"></span>

<p>原文地址：<a target="_blank" rel="noopener" href="https://www.programmersought.com/article/72346565091/">https://www.programmersought.com/article/72346565091/</a></p>
<p>零拷贝（Zero Copy）是一个耳熟能详的名词，很多高性能网络框架如Netty，Kafka，RocketMQ都将零拷贝作为其特点。那么究竟什么是零拷贝？</p>
<h1 id="Zero-copy"><a href="#Zero-copy" class="headerlink" title="Zero copy"></a>Zero copy</h1><p>维基百科对零拷贝的定义如下：</p>
<blockquote>
<p>“Zero-copy” describes computer operations in which the CPU does not perform the task of copying data from one memory area to another. This is frequently used to save CPU cycles and memory bandwidth when transmitting a file over a network.</p>
</blockquote>
<p>“零拷贝”描述了计算机操作，其中 CPU 不执行将数据从一个内存区域复制到另一个内存区域的任务。这通常用于在通过网络传输文件时节省 CPU 周期和内存带宽。</p>
<h1 id="Zero-copy-in-Linux-system"><a href="#Zero-copy-in-Linux-system" class="headerlink" title="Zero copy in Linux system"></a>Zero copy in Linux system</h1><h3 id="术语"><a href="#术语" class="headerlink" title="术语"></a>术语</h3><ul>
<li><p><strong>内核空间</strong></p>
<p>计算机内存分为用户空间和内核空间。内核空间运行OS内核代码，可以访问所有内存、机器指令和硬件资源，拥有最高权限。</p>
</li>
<li><p><strong>用户空间</strong></p>
<p>内核外部的所有空间，用于正常的用户进程操作。用户空间的进程不能访问内核空间，只能通过内核系统调用(系统调用)公开的接口访问内核的一小部分。如果用户进程请求执行系统调用，则需要向内核发送系统中断(软件中断)，内核会调度相应的中断处理程序来处理请求。</p>
</li>
<li><p><strong>DMA</strong></p>
<p>直接内存访问(DMA)是为了响应CPU与硬盘之间的速度大小不匹配，它允许某些硬件子系统独立于CPU主存进行访问。</p>
<p>如果没有DMA、CPU执行IO操作的整个过程被阻塞，无法执行其他工作，这将导致计算机陷入挂起。如果有DMA干预，IO过程就变成这样了：CPU启动DMA传输过程中，可以执行其他操作；DMA控制器（DMAC）传输完成后，会给CPU发送一个中断信号，然后CPU就可以对传输的数据进行处理了。</p>
</li>
</ul>
<h3 id="Traditional-network-transmission"><a href="#Traditional-network-transmission" class="headerlink" title="Traditional network transmission"></a>Traditional network transmission</h3><p>网络IO的一个常见场景是从硬盘读取文件，通过网卡发送到网络。下面是一个简单的伪代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// read data from hard disk</span></span><br><span class="line">File.read(fileDesc, buf, len);</span><br><span class="line"><span class="comment">// Send data to the network</span></span><br><span class="line">Socket.write(socket, buf, len);</span><br></pre></td></tr></table></figure>



<p>在代码层面，这是一个非常简单的操作，但在系统层面，让我们看看幕后发生了什么：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619211045SSoeFe.jpg" alt="20210619211045SSoeFe"></p>
<ol>
<li>User initiated  <code>read()</code>  System call (<code>syscall</code>), request hard disk data. At this point, it will happen once <strong>Context switch</strong>(context switch)。</li>
<li><code>DMA</code>  Read the file from the hard disk. At this time, a copy is generated:<strong>hard disk</strong>–&gt;<strong>DMA buffer</strong>。</li>
<li><code>DMA</code> Copy data to<strong>User space</strong>，<code>read()</code>  The call returns. At this time, it happened once <strong>Context switch</strong> And a data copy: <strong>DMA buffer</strong>–&gt;<strong>User space</strong>。</li>
<li>User initiated  <code>write()</code>  System call, request to send data. This happens once <strong>Context switch</strong> And a data copy: <strong>User space</strong>–&gt;<strong>DMA buffer</strong>。</li>
<li><code>DMA</code> Copy the data to the network card for network transmission. The fourth data copy occurs at this time:<strong>DMA buffer</strong>–&gt;<strong>Socket buffer</strong></li>
<li><code>write()</code> The call returns and happens again <strong>Context switch</strong>。</li>
</ol>
<p>数据流如下：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619211517AlprCv.jpg" alt="20210619211517AlprCv"></p>
<p>可以发现，涉及4次上下文切换和4次数据拷贝。对于简单的网络文件发送，有很多不必要的开销。</p>
<h3 id="sendfile-transmission"><a href="#sendfile-transmission" class="headerlink" title="sendfile transmission"></a><code>sendfile</code> transmission</h3><p>对于上面的场景，可以发现从<strong>DMA缓冲区到用户空间</strong>和从用户空间到套接字缓冲区两次CPU复制是完全没有必要的，零拷贝由此诞生。针对这种情况，Linux内核提供了<code>sendfile</code>系统调用。</p>
<p>如果使用<code>sendfile()</code>执行上述请求，系统流程可以简化如下：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619212016ieRHQD.jpg" alt="20210619212016ieRHQD"></p>
<p><code>sendfile()</code>系统调用，可以在DMA中实现数据的内部复制，而不需要将数据复制到用户空间。因此，<strong>上下文切换次数</strong>减少到2次，<strong>数据拷贝次数</strong>减少到3次。</p>
<p>Here is a question: <strong>why<code>DMA</code>There will be a copy inside (this copy needs<code>CPU</code>participate)</strong>?</p>
<p>This is because the early network cards required the data to be sent to be <strong>continuous</strong> in physical space, so there was<code>Socket Buffer</code>. But if the network card itself supports <code>scatter-gather</code>, that is, it can gather and send data from discontinuous memory addresses, then it can be further optimized.</p>
<h3 id="Network-card-support-scatter-gather-of-sendfile-transmission"><a href="#Network-card-support-scatter-gather-of-sendfile-transmission" class="headerlink" title="Network card support scatter-gather of sendfile transmission"></a>Network card support <code>scatter-gather</code> of <code>sendfile</code> transmission</h3><p>in<code>Linux</code>This has been optimized after kernel version 2.4. If the computer network card supports the collection operation,<code>sendfile()</code>Operation can be omitted<code>Socket Buffer</code>The data is copied, instead, the descriptors of the data location and length are directly passed to<code>Socket Buffer</code>：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619212541y7show.jpg" alt="20210619212541y7show"></p>
<p>在网卡的支持下，上下文切换次数为2次，数据复制次数也减少到2次。两次数据复制是必须的，即数据在内存中复制已经完全避免了。</p>
<p>对于从硬盘向网络发送文件的场景，如果网卡支持采集操作，那么<code>sendfile()</code>系统调用，真正意义上的零拷贝。</p>
<h3 id="Memory-mapping-mmap"><a href="#Memory-mapping-mmap" class="headerlink" title="Memory mapping (mmap)"></a>Memory mapping (mmap)</h3><p>在“通过互联网发送文件”的情况下，使用<code>sendfile()</code>系统调用可以极大地提高性能(根据测试，吞吐量可以达到传统方法的三倍)。但有一个缺点是，它只支持“读-&gt;发送”的“连续操作”，所以，<code>sendfile()</code>一般用来处理一些静态的网络资源，如果要对数据进行额外的操作，它是无能为力的。内存映射（Memory mapping）为此提供了一种解决方案。</p>
<p>mmap是一种内存映射文件的方法。它可以将文件映射到进程的地址空间，实现文件磁盘地址和进程虚拟地址空间中虚拟地址的对应。这样，用户进程就可以使用指针对这块内存进行读写操作，内核空间对这块内存的修改直接反映在用户空间中。</p>
<p>简而言之，mmap实现了用户空间和内核空间的数据共享。可以猜到，如果使用<code>mmap</code> 系统调用，上述场景的步骤如下：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619213243qeFckV.jpg" alt="20210619213243qeFckV"></p>
<p>数据流如下：</p>
<p><img src="https://gitee.com/niumi/drawing/raw/master/20210619213506rcq3a0.jpg" alt="20210619213506rcq3a0"></p>
<p>**与传统方式相比，mmap它保存了一份数据拷贝，这也可以从广义上称为零拷贝(Zero Copy)**。同时，它还允许用户自定义数据操作，这与发送文件相比，其优势在于。</p>
<h1 id="Zero-copy-in-JDK-NIO"><a href="#Zero-copy-in-JDK-NIO" class="headerlink" title="Zero copy in JDK NIO"></a>Zero copy in JDK NIO</h1><p>从1.4版开始，JDK引入了NIO，提供了正确的Zero Copy支持。由于JVM运行在上述操作系统上，其功能只是对系统底层API的封装，如果操作系统不支持Zero Copy(mmap/sendfile)，那么JVM就无能为力了。JDK正确的Zero Copy Package，主要体现在FileChannel这个类上。</p>
<h2 id="map"><a href="#map" class="headerlink" title="map()"></a>map()</h2><p><code>map()</code>方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">FileChannel</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractInterruptibleChannel</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">SeekableByteChannel</span>, <span class="title">GatheringByteChannel</span>, <span class="title">ScatteringByteChannel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> MappedByteBuffer <span class="title">map</span><span class="params">(MapMode mode, <span class="keyword">long</span> position, <span class="keyword">long</span> size)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>map()</code>方法描述如下：</p>
<blockquote>
<p>将此通道文件的一个区域直接映射到内存中。对于大多数操作系统来说，将文件映射到内存比通过通常的读写方法读取或写入数十KB的数据更昂贵。<strong>从性能的角度来看，通常只值得将相对较大的文件映射到内存中</strong>。</p>
</blockquote>
<p>map()方法返回<code>MappdByteBuffer</code>，<code>DirectByteBuffer</code>就是它的子类别。它引用一个独立于JVM内存的块，它位于GC之外，由该机制控制，<strong>您需要自己管理创建和销毁操作</strong>。</p>
<h2 id="transferTo"><a href="#transferTo" class="headerlink" title="transferTo()"></a>transferTo()</h2><p><code>transferTo()</code>方法如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">FileChannel</span></span></span><br><span class="line"><span class="class">    <span class="keyword">extends</span> <span class="title">AbstractInterruptibleChannel</span></span></span><br><span class="line"><span class="class">    <span class="keyword">implements</span> <span class="title">SeekableByteChannel</span>, <span class="title">GatheringByteChannel</span>, <span class="title">ScatteringByteChannel</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">long</span> <span class="title">transferTo</span><span class="params">(<span class="keyword">long</span> position, <span class="keyword">long</span> count, WritableByteChannel target)</span> <span class="keyword">throws</span> IOException</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<p><code>transferTo()</code>方法描述如下：</p>
<blockquote>
<p>将字节从此通道的文件传输到给定的可写字节通道时，此方法可能比从此通道读取并写入目标通道的简单循环高效得多。</p>
<p>许多操作系统可以直接将字节从文件系统缓存传输到目标通道，而无需实际复制它们。</p>
</blockquote>
<p>请注意，由于<code>sendfile()</code>只适用于套接字缓冲区发送数据，因此通过Zero Copy技术提高性能只能用于通过网络发送数据的场景。</p>
<p>那是什么意思？<strong>如果您只是使用Transfer To()将数据从硬盘上的一个文件写入到另一个文件，则不会产生任何性能提升效果。</strong></p>
<h1 id="Zero-copy-in-Netty"><a href="#Zero-copy-in-Netty" class="headerlink" title="Zero copy in Netty"></a>Zero copy in Netty</h1><p>// todo </p>
</div><div class="article-licensing box"><div class="licensing-title"><p>零拷贝</p><p><a href="http://blog.blockmao.cn/posts/45215.html">http://blog.blockmao.cn/posts/45215.html</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>牛觅</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2021-06-19</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2021-06-19</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E9%9B%B6%E6%8B%B7%E8%B4%9D/">零拷贝</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Like this article? Support the author with</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Buy me a coffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/posts/7199.html"><i class="level-item fas fa-chevron-left"></i><span class="level-item">微服务安全架构：基于OAuth 2.0/JWT的微服务参考架构</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/posts/45222.html"><span class="level-item">Spring：XML配置扩展</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/avatar.png" alt="牛觅"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">牛觅</p><p class="is-size-6 is-block">Your title</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国-杭州</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Posts</p><a href="/archives"><p class="title">77</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Categories</p><a href="/categories"><p class="title">19</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">18</p></a></div></div></nav><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/ppoffice"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Facebook" href="https://facebook.com"><i class="fab fa-facebook"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Twitter" href="https://twitter.com"><i class="fab fa-twitter"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Dribbble" href="https://dribbble.com"><i class="fab fa-dribbble"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/"><i class="fas fa-rss"></i></a></div></div></div><!--!--><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">Categories</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/DDD/"><span class="level-start"><span class="level-item">DDD</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Dubbo/"><span class="level-start"><span class="level-item">Dubbo</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Git/"><span class="level-start"><span class="level-item">Git</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/Hbase/"><span class="level-start"><span class="level-item">Hbase</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/JVM/"><span class="level-start"><span class="level-item">JVM</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/JavaSE/"><span class="level-start"><span class="level-item">JavaSE</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/"><span class="level-start"><span class="level-item">Java并发编程</span></span><span class="level-end"><span class="level-item tag">11</span></span></a></li><li><a class="level is-mobile" href="/categories/MySQL/"><span class="level-start"><span class="level-item">MySQL</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/Mybatis/"><span class="level-start"><span class="level-item">Mybatis</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/Netty/"><span class="level-start"><span class="level-item">Netty</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/Spring/"><span class="level-start"><span class="level-item">Spring</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/categories/SpringCloud/"><span class="level-start"><span class="level-item">SpringCloud</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="level-start"><span class="level-item">分布式</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/categories/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84/"><span class="level-start"><span class="level-item">微服务架构</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E4%B8%8E%E7%AE%97%E6%B3%95/"><span class="level-start"><span class="level-item">数据结构与算法</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%97%A5%E5%BF%97/"><span class="level-start"><span class="level-item">日志</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="level-start"><span class="level-item">计算机网络</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%BE%E8%AE%A1/"><span class="level-start"><span class="level-item">设计</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"><span class="level-start"><span class="level-item">设计模式</span></span><span class="level-end"><span class="level-item tag">21</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Recents</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-09T10:36:51.000Z">2021-08-09</time></p><p class="title"><a href="/posts/22384.html">MySQL：索引</a></p><p class="categories"><a href="/categories/MySQL/">MySQL</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-08-07T03:38:43.000Z">2021-08-07</time></p><p class="title"><a href="/posts/60776.html">Java Agent</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-21T12:58:45.000Z">2021-07-21</time></p><p class="title"><a href="/posts/51998.html">Java类加载：classloader的原理及应用</a></p><p class="categories"><a href="/categories/JVM/">JVM</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-19T05:47:30.000Z">2021-07-19</time></p><p class="title"><a href="/posts/19955.html">Netty：ByteBuf与内存管理</a></p><p class="categories"><a href="/categories/Netty/">Netty</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2021-07-16T03:00:08.000Z">2021-07-16</time></p><p class="title"><a href="/posts/7199.html">微服务安全架构：基于OAuth 2.0/JWT的微服务参考架构</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archives</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">August 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">July 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">June 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">May 2021</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">April 2021</span></span><span class="level-end"><span class="level-item tag">51</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">March 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/JVM/"><span class="tag">JVM</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Java-8/"><span class="tag">Java 8</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Mybatis/"><span class="tag">Mybatis</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Netty/"><span class="tag">Netty</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/OAuth2/"><span class="tag">OAuth2</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/TODO/"><span class="tag">TODO</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/"><span class="tag">分布式</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"><span class="tag">分布式事务</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98/"><span class="tag">分布式缓存</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%88%9B%E5%BB%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/"><span class="tag">创建型模式</span><span class="tag">4</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/"><span class="tag">微服务</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8/"><span class="tag">微服务安全</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8E%92%E5%BA%8F/"><span class="tag">排序</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%B3%9B%E5%9E%8B/"><span class="tag">泛型</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%93%E6%9E%84%E5%9E%8B%E6%A8%A1%E5%BC%8F/"><span class="tag">结构型模式</span><span class="tag">6</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%A1%8C%E4%B8%BA%E5%9E%8B%E6%A8%A1%E5%BC%8F/"><span class="tag">行为型模式</span><span class="tag">11</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9B%B6%E6%8B%B7%E8%B4%9D/"><span class="tag">零拷贝</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95%E9%A2%98/"><span class="tag">面试题</span><span class="tag">2</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Subscribe for updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Subscribe"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="牛觅博客" height="28"></a><p class="is-size-7"><span>&copy; 2021 牛觅</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-Hanss");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Back to top" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "This website uses cookies to improve your experience.",
          dismiss: "Got it!",
          allow: "Allow cookies",
          deny: "Decline",
          link: "Learn more",
          policy: "Cookie Policy",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Type something..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Type something...","untitled":"(Untitled)","posts":"Posts","pages":"Pages","categories":"Categories","tags":"Tags"});
        });</script></body></html>